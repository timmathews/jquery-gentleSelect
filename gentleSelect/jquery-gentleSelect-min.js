(function(a){function c(a){return typeof a=="undefined"?!1:!0}function d(b,d){return c(d.columns)&&c(d.rows)?(a.error("gentleSelect: You cannot supply both 'rows' and 'columns'"),!0):c(d.columns)&&!c(d.itemWidth)?(a.error("gentleSelect: itemWidth must be supplied if 'columns' is specified"),!0):c(d.rows)&&!c(d.itemWidth)?(a.error("gentleSelect: itemWidth must be supplied if 'rows' is specified"),!0):!c(d.openSpeed)||typeof d.openSpeed!="number"&&typeof d.openSpeed=="string"&&d.openSpeed!="slow"&&d.openSpeed!="fast"?(a.error('gentleSelect: openSpeed must be an integer or "slow" or "fast"'),!0):!c(d.closeSpeed)||typeof d.closeSpeed!="number"&&typeof d.closeSpeed=="string"&&d.closeSpeed!="slow"&&d.closeSpeed!="fast"?(a.error('gentleSelect: closeSpeed must be an integer or "slow" or "fast"'),!0):!c(d.openEffect)||d.openEffect!="fade"&&d.openEffect!="slide"?(a.error("gentleSelect: openEffect must be either 'fade' or 'slide'!"),!0):!c(d.closeEffect)||d.closeEffect!="fade"&&d.closeEffect!="slide"?(a.error("gentleSelect: closeEffect must be either 'fade' or 'slide'!"),!0):!c(d.hideOnMouseOut)||typeof d.hideOnMouseOut!="boolean"?(a.error('gentleSelect: hideOnMouseOut must be supplied and either "true" or "false"!'),!0):!1}var b={minWidth:100,itemWidth:undefined,columns:undefined,rows:undefined,title:undefined,prompt:"Make A Selection",maxDisplay:4,openSpeed:400,closeSpeed:400,openEffect:"slide",closeEffect:"slide",hideOnMouseOut:!0},e=null,f={init:function(f){e=a.extend({},b,f);if(d(this,e))return this;this.hide();var h=this.find(":selected");if(h.length>e.maxDisplay)var i="Multiple Selections";else if(h.length<1)var i=e.prompt;else var i=h.map(function(){return a(this).text()}).get().join(", ");var j=a("<span class='gentleselect-label'>"+i+"</span>").insertBefore(this).bind("mouseenter.gentleselect",g.labelHoverIn).bind("mouseleave.gentleselect",g.labelHoverOut).bind("click.gentleselect",g.labelClick).data("root",this);this.data("label",j).data("options",e);var k=a("<ul></ul>");this.find("option").each(function(){var b=a("<li>"+a(this).text()+"</li>").data("value",a(this).attr("value")).data("name",a(this).text()).appendTo(k);a(this).attr("selected")&&b.addClass("selected")});var l=a("<div class='gentleselect-dialog'></div>").append(k).insertAfter(j).bind("mouseleave.gentleselect",g.dialogHoverOut).data("label",j).data("root",this);this.data("dialog",l),this.attr("multiple")?(l.data("multiple",!0),l.bind("click.gentleselect",g.multiselectDialogClick)):(l.data("multiple",!1),l.bind("click.gentleselect",g.dialogClick));if(c(e.columns)||c(e.rows)){k.css("float","left").find("li").width(e.itemWidth).css("float","left");var m=k.find("li:first"),n=e.itemWidth+parseInt(m.css("padding-left"))+parseInt(m.css("padding-right")),p=k.find("li").length;if(c(e.columns))var q=parseInt(e.columns),r=Math.ceil(p/q);else var r=parseInt(e.rows),q=Math.ceil(p/r);l.width(n*q);for(var s=0;s<r*q-p;s++)a("<li style='float:left' class='gentleselect-dummy'><span>&nbsp;</span></li>").appendTo(k);var t=[],u=0;k.find("li").each(function(){if(u<r)t[u]=a(this);else{var b=u%r;a(this).insertAfter(t[b]),t[b]=a(this)}u++})}else typeof e.minWidth=="number"&&l.css("min-width",e.minWidth);return c(e.title)&&a("<div class='gentleselect-title'>"+e.title+"</div>").prependTo(l),a(document).bind("keyup.gentleselect",g.keyUp),this},update:function(){var b=this,c=this.val();if(a.isArray(c)){this.data("dialog").find("li").each(function(){a.inArray(a(this).data("value"),c)>=0&&a(this).addClass("selected")});var d=this.find(":selected");if(d.length>e.maxDisplay)var f="Multiple Selections";else if(d.length<1)var f=e.prompt;else var f=d.map(function(){return a(this).text()}).get().join(", ");this.data("label").text(f)}else this.data("dialog").find("li").each(function(){a(this).data("value")==c?(a(this).addClass("selected"),b.data("label").text(a(this).data("name"))):a(this).removeClass("selected")});return this}},g={labelHoverIn:function(){a(this).addClass("gentleselect-label-highlight")},labelHoverOut:function(){a(this).removeClass("gentleselect-label-highlight")},labelClick:function(){var b=a(this).position(),c=a(this).data("root"),d=c.data("options"),e=c.data("dialog").css("top",b.top+c.height()).css("left",b.left+1);d.openEffect=="fade"?e.fadeIn(d.openSpeed):e.slideDown(d.openSpeed)},dialogHoverOut:function(){a(this).data("root").data("options").hideOnMouseOut&&a(this).hide()},dialogClick:function(b){var c=a(b.target),d=a(this).data("root").data("options");d.closeEffect=="fade"?a(this).fadeOut(d.closeSpeed):a(this).slideUp(d.closeSpeed);if(c.is("li")&&!c.hasClass("gentleselect-dummy")){var e=c.data("value"),f=c.data("name"),g=a(this).data("label").text(f);a(this).find("li.selected").removeClass("selected"),c.addClass("selected");var h=a(this).data("root").val(e).trigger("change")}},multiselectDialogClick:function(b){var c=a(b.target),d=a(this).data("root").data("options");if(c.is("li")&&!c.hasClass("gentleselect-dummy")){var e=c.data("value"),f=c.data("name"),g=a(this).data("label");c.hasClass("selected")?c.removeClass("selected"):c.addClass("selected");var h=a(this).find("li.selected").map(function(){return a(this).data("value")}).get(),i=a(this).find("li.selected").map(function(){return a(this).text()}).get().sort().join(", ");h.length>d.maxDisplay?g.text("Multiple Selections"):h.length<1?g.text(d.prompt):g.text(i);var j=a(this).data("root").val(h).trigger("change")}},keyUp:function(b){b.keyCode==27&&a(".gentleselect-dialog").hide()}};a.fn.gentleSelect=function(b){if(f[b])return f[b].apply(this,Array.prototype.slice.call(arguments,1));if(typeof b=="object"||!b)return f.init.apply(this,arguments);a.error("Method "+b+" does not exist on jQuery.gentleSelect")}})(jQuery);